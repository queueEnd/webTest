import{bc as e,al as a,bd as t,be as n,bf as o,bg as l,bh as s,_ as i,o as u,i as r,w as c,g as h,y as d,b9 as g,q as f,bi as v,bj as b}from"./index-FwbBwjbJ.js";const m={height:{type:Number,default:0},defaultAnchor:{type:Number,default:0},anchors:{type:Array,default:()=>[]},animation:{type:Boolean,default:!0},contentDraggable:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!0},bgColor:String,barColor:String};function p(e){return function(e){return null!=e}(e)?function(e){return/^(-)?\d+(\.\d+)?$/.test(e)}(e=String(e))?`${e}px`:e:null}const y=(e=300)=>new Promise((a=>setTimeout(a,e)));const T=i(e({name:"l-floating-panel",props:m,emits:["heightChange","change","update:height"],setup(e,{emit:i,expose:u}){const{windowHeight:r,safeAreaInsets:c}=a(),h=t(!e.contentDraggable),d=t(!1),g=t(!1),f=t(!1),v=n((()=>{const a=e.anchors||[];return{min:a[0]??100,max:a[a.length-1]??Math.round(.6*r)}})),b=e=>v.value.max-e,m=n((()=>{const a=e.anchors||[];return a.length>=2?a:[v.value.min,v.value.max]})),T=n((()=>({height:p(2*v.value.max-v.value.min),bottom:p(-1*v.value.max+v.value.min+(e.safeAreaInsetBottom?c.bottom:0)),opacity:f.value?1:0}))),x=n((()=>({height:p(v.value.max),background:e.baColor}))),_=t(b(e.anchors[e.defaultAnchor])??b(v.value.min));let A=[],C=0;const B=e=>{_.value=e+.1,y(50).then((()=>{_.value=e;const a=b(e);let t=m.value.findIndex((e=>e==a));i("heightChange",{height:a}),i("change",{height:a,index:t})}))},I=e=>{e>=0&&e<m.value.length&&B(b(m.value[e]))},D=()=>{e.contentDraggable||y(50).then((()=>h.value=!0))},S=o((()=>e.anchors),(()=>{const e=m.value.findIndex((e=>e==b(_.value)))+1;I(e)}));return l((()=>{d.value=e.animation,y(50).then((()=>f.value=!0))})),s((()=>{S()})),u({toAnchor:I}),{initialized:f,areaStyles:T,styles:x,isDraggable:h,isAnimation:d,currentY:_,onTouchstart:a=>{C=a.touches[0].clientY,g.value=!0,A.length=0;const{handle:t}=a.target.dataset;e.contentDraggable||!Boolean(t)||(h.value=!1)},onTouchmove:e=>{const{y:a}=e.detail;g.value&&A.push(a);const t=b(a);i("update:height",t)},onTouchend:e=>{let a=0;g.value=!1;const{handle:t}=e.target.dataset,n=Math.abs(e.changedTouches[0].clientY-C)<10;if(!n||Boolean(t)){if(n){const e=m.value.findIndex((e=>e==b(_.value)))+1;return I(e%m.value.length),void D()}var o,l;A.length&&(a=A[A.length-1]),A.length=0,D(),B(b((o=m.value,l=b(a),o.reduce(((e,a)=>Math.abs(e-l)<Math.abs(a-l)?e:a)))))}else D()}}}}),[["render",function(e,a,t,n,o,l){const s=f,i=v,m=b;return u(),r(m,{class:"l-floating-panel-area",style:d([e.areaStyles]),"data-initialized":e.initialized},{default:c((()=>[h(i,{class:"l-floating-panel",direction:"vertical",inertia:"","out-of-bounds":"",damping:80,friction:100,disabled:e.isDraggable,y:e.currentY,animation:e.isAnimation,onChange:e.onTouchmove,onTouchstart:e.onTouchstart,onTouchend:e.onTouchend,onTouchcancel:e.onTouchend,style:d([e.styles])},{default:c((()=>[h(s,{class:"l-floating-panel__header","data-handle":"true"},{default:c((()=>[h(s,{class:"l-floating-panel__header-bar",style:d({background:e.barColor})},null,8,["style"])])),_:1}),h(s,{class:"l-floating-panel__content"},{default:c((()=>[g(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["disabled","y","animation","onChange","onTouchstart","onTouchend","onTouchcancel","style"])])),_:3},8,["style","data-initialized"])}],["__scopeId","data-v-4a974f8b"]]);export{T as _};
