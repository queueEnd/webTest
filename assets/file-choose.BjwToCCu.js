import{ak as e,bi as t,bj as a,bk as i,bl as s,_ as o,o as l,i as n,q as r,aI as c,r as p,c as d,w as u,g as A,m,s as f,A as h,d as g,f as y,l as C,F as b,j as I,k as v,t as S,ai as E,p as F}from"./index-B3fvMXoi.js";var P;const O={get isIOS(){return"boolean"==typeof P?P:P="ios"===e().platform},requestIOS:function(e){return new Promise(((t,a)=>{switch(e){case"push":t(function(){var e=0,t=plus.ios.import("UIApplication"),a=t.sharedApplication();if(a.currentUserNotificationSettings){var i=a.currentUserNotificationSettings();0==i.plusGetAttribute("types")?(e=0,console.log("推送权限没有开启")):(e=1,console.log("已经开启推送功能!")),plus.ios.deleteObject(i)}else 0==a.enabledRemoteNotificationTypes()?(e=3,console.log("推送权限没有开启!")):(e=4,console.log("已经开启推送功能!"));return plus.ios.deleteObject(a),plus.ios.deleteObject(t),e}());break;case"location":t((i=0,s=plus.ios.import("CLLocationManager"),o=s.locationServicesEnabled(),l=s.authorizationStatus(),i=o?0===l?null:3===l||4===l?1:0:2,plus.ios.deleteObject(s),i));break;case"record":t(function(){var e=null,t=plus.ios.import("AVAudioSession"),a=t.sharedInstance().recordPermission();return console.log("permissionStatus:"+a),e=1970168948===a?null:1735552628===a?1:0,plus.ios.deleteObject(t),e}());break;case"camera":t(function(){var e=0,t=plus.ios.import("AVCaptureDevice"),a=t.authorizationStatusForMediaType("vide");return e=0===a?null:3==a?1:0,plus.ios.deleteObject(t),e}());break;case"album":t(function(){var e=0,t=plus.ios.import("PHPhotoLibrary"),a=t.authorizationStatus();return e=0===a?null:3==a?1:0,plus.ios.deleteObject(t),e}());break;case"contact":t(function(){var e=0,t=plus.ios.import("CNContactStore"),a=t.authorizationStatusForEntityType(0);return e=0===a?null:3==a?1:0,plus.ios.deleteObject(t),e}());break;case"calendar":t(function(){var e=null,t=plus.ios.import("EKEventStore");return 3==t.authorizationStatusForEntityType(0)?(e=1,console.log("日历权限已经开启")):console.log("日历权限没有开启"),plus.ios.deleteObject(t),e}());break;case"memo":t(function(){var e=null,t=plus.ios.import("EKEventStore");return 3==t.authorizationStatusForEntityType(1)?(e=1,console.log("备忘录权限已经开启")):console.log("备忘录权限没有开启"),plus.ios.deleteObject(t),e}());break;default:t(0)}var i,s,o,l}))},requestAndroid:function(e){return new Promise(((t,a)=>{plus.android.requestPermissions([e],(function(e){for(var a=0,i=0;i<e.granted.length;i++){var s=e.granted[i];console.log("已获取的权限："+s),a=1}for(i=0;i<e.deniedPresent.length;i++){var o=e.deniedPresent[i];console.log("拒绝本次申请的权限："+o),a=0}for(i=0;i<e.deniedAlways.length;i++){var l=e.deniedAlways[i];console.log("永久拒绝申请的权限："+l),a=-1}t(a)}),(function(e){console.log("result error: "+e.message),t({code:e.code,message:e.message})}))}))},gotoAppSetting:function(){if(O.isIOS){var e=plus.ios.import("UIApplication").sharedApplication(),t=plus.ios.import("NSURL"),a=t.URLWithString("app-settings:");e.openURL(a),plus.ios.deleteObject(a),plus.ios.deleteObject(t),plus.ios.deleteObject(e)}else{var i=plus.android.importClass("android.content.Intent"),s=plus.android.importClass("android.provider.Settings"),o=plus.android.importClass("android.net.Uri"),l=plus.android.runtimeMainActivity(),n=new i;n.setAction(s.ACTION_APPLICATION_DETAILS_SETTINGS);var r=o.fromParts("package",l.getPackageName(),null);n.setData(r),l.startActivity(n)}}},T=e=>!!e&&Array.isArray(e),j=e=>e.then((e=>[null,e])).catch((e=>[e,{}])),D=e=>{if(!(t=e,t&&"[object Object]"===Object.prototype.toString.call(t)||T(e)))return e;var t;const a=T(e)?[]:{};for(let i in e)e.hasOwnProperty(i)&&(e[i]&&"object"==typeof e[i]?(a[i]=T(e[i])?[]:{},a[i]=D(e[i])):a[i]=e[i]);return a},U=(e={},t={})=>{if("object"!=typeof(e=D(e))||"object"!=typeof t)return!1;for(const a in t)t.hasOwnProperty(a)&&(a in e?"object"!=typeof e[a]||"object"!=typeof t[a]?e[a]=t[a]:e[a].concat&&t[a].concat?e[a]=e[a].concat(t[a]):e[a]=U(e[a],t[a]):e[a]=t[a]);return e},k=(e,t)=>e?uni.chooseMedia||"image"!==e?uni.chooseMedia||"video"!==e?j(new Promise(((a,i)=>{uni.chooseMedia({...t,mediaType:[e],success:e=>a(e),fail:e=>i({mode:"chooseMedia",data:e})})}))):(e=>j(new Promise(((t,a)=>{s({...e,success:e=>{var a;const i=[{...e,tempFilePath:e.tempFilePath,tempFile:e.tempFile??{},size:e.size,name:e.name,type:null==(a=e.tempFile)?void 0:a.type,fileType:"video"}];return t({type:"video",tempFiles:i})},fail:e=>a({mode:"chooseVideo",data:e})})}))))(t):(e=>j(new Promise(((t,a)=>{i({...e,success:e=>{const a=null==e?void 0:e.tempFiles.map((e=>({tempFilePath:e.path,tempFile:e,size:e.size,name:e.name,type:e.type,fileType:"image"})));return t({type:"image",...e,tempFiles:a})},fail:e=>a({mode:"chooseImage",data:e})})}))))(t):console.error("chooseMedia type cannot be empty");const N=o({name:"XeUpload",props:{options:{default:()=>({}),type:Object}},data:()=>({id:0,renderInput:""}),computed:{mergeOptions:({options:e={}})=>U({name:"file"},e),mergeProps:({id:e,renderInput:t,mergeOptions:a})=>({id:e,renderInput:t,upload:a})},methods:{async upload(e,a={}){let i=[];if(["image","video"].includes(e)){const[t,s]=await k(e,a);if(t)return this.handleError(t);i=(null==s?void 0:s.tempFiles)||[]}if(["file"].includes(e)){let e={},s=null;if([s,e]=await(e=>j(new Promise(((a,i)=>{t({...e,success:e=>{const t=null==e?void 0:e.tempFiles.map((e=>{let t="file";return e.type.includes("image")&&(t="image"),e.type.includes("video")&&(t="video"),{tempFilePath:e.path,tempFile:e,size:e.size,name:e.name,type:e.type,fileType:t}}));return a({type:"file",...e,tempFiles:t})},fail:e=>i({mode:"chooseFile",data:e})})}))))(a),s)return this.handleError(s);i=(null==e?void 0:e.tempFiles)||[]}this.handleUpload(i)},initInput(e){const{id:t}=this;let a=e;T(e)&&(a=e.join(",")),this.renderInput=`<input type="file" id="xe-upload-${t}" name="xe-upload" ${a?'accept="'+a+'"':""} />`},async handleUpload(e=[]){if(0===e.filter((e=>Boolean(e))).length)return;const{mergeOptions:t}=this;if(!t.url)return this.handleEmits({type:"choose",data:e});const i=e.map((e=>((e,t={})=>new Promise(((i,s)=>{a({...e,success:e=>i({...t,response:JSON.parse(e.data)}),fail:e=>s({mode:"uploadFile",data:e})})})))({...t,filePath:e.tempFilePath},e))),[s,o]=await j(Promise.all(i));if(s)return this.handleError(s);this.handleEmits({type:"success",data:o})},handleError(e){this.handleEmits({type:"warning",data:e})},async handleEmits(e){this.$emit("callback",e)}}},[["render",function(e,t,a,i,s,o){const c=r;return l(),n(c)}],["__scopeId","data-v-a096a813"]]);const z=o({components:{fileChooseItem:o({name:"fileChooseItem",emits:["fileChoosed"],data:()=>({uploadOptions:{},files:[]}),methods:{async chooseFileTo(){console.log("1111111"),this.$refs.XeUpload.upload("file")},handleUploadCallback(e){console.log("UploadCallback",e),this.$emit("fileChoosed",e)},async checkPermission(e){let t=O.isIOS?await O.requestIOS("camera"):await O.requestAndroid("android.permission.READ_EXTERNAL_STORAGE");return null===t||1===t?t=1:c({content:"没有开启权限",confirmText:"设置",success:function(e){e.confirm&&O.gotoAppSetting()}}),t}}},[["render",function(e,t,a,i,s,o){const c=m,f=p(d("xe-upload"),N),h=r;return l(),n(h,{class:"file-item"},{default:u((()=>[A(c,{class:"preview-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACICAMAAAALZFNgAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAA/UExURUdwTPr6+vj4+Pr6+vn5+fr6+vj4+Pn5+f////n5+fn5+fn5+b/BwcjKysrMzPj4+Ovs7NfY2MrLy/T09MDCwsNC6Z4AAAALdFJOUwDyvbz8j5TUBivyXRVVLAAAAPpJREFUeNrt3LEOgyAYRWFoAbUgovj+z1ppV5caE2/sOavLl2hc/uQaszX4zsaLsp0fzLc+uHhpLvQfxyNe3rNJQhQobN+HU4C4wfgokTedBqQzVgNiTRQJCBAgQIAAAQIECBAgQIAAAQLk56ZSJgVIXVJaqgBkTluzACQ3SBaAjA0yAgECBAgQIECAAAECRA5S5zzutjbIuv8sz/VsyLSkQy3TyZCSDlbuCpF5NTIfK/8RIECAAAECBAgQIEDuA5E5pckcF2XOrTIH6JMCAgQIECBAgAABAgQIECBAgPwdRGTA4KUz6SAzciEz+yEzhKIzDSMzliMyH/QGgTUcgfPfgzEAAAAASUVORK5CYII=",mode:"aspectFill",onClick:o.chooseFileTo},null,8,["onClick"]),A(f,{ref:"XeUpload",onCallback:o.handleUploadCallback},null,8,["onCallback"])])),_:1})}],["__scopeId","data-v-76d5eefe"]])},emits:["filesChange"],props:{editFiles:{type:Array,default:[]}},data:()=>({fileDatas:[],imageDatas:[],docDatas:[]}),watch:{editFiles(e){e&&e.forEach((e=>{const t={netPath:e.filePath,name:e.fileName,type:e.fileType,netName:e.fileName,netType:e.fileType};this.fileDatas.push(t),this.classify(),this.$emit("filesChange",this.fileDatas)}))}},methods:{iconForFile:e=>e.name.endsWith("xlsx")||e.name.endsWith("xls")?"/static/image/common/file_xls.png":e.name.endsWith("doc")||e.name.endsWith("docx")?"/static/image/common/file_doc.png":e.name.endsWith("pdf")?"/static/image/common/file_pdf.png":"/static/image/common/file_other.png",actionToChoose(e){this.$refs.fchoose.chooseFileTo()},fileChoosed(e){console.log(e.data);var t=!1;e.data.forEach((e=>{e.size<512e4?(e.path=e.tempFilePath,this.fileDatas.push(e)):t=!0})),t&&f({icon:"none",title:"文件大小不能超过5MB"}),this.classify(),this.$emit("filesChange",this.fileDatas)},async checkPermission(e){let t=O.isIOS?await O.requestIOS("camera"):await O.requestAndroid("android.permission.READ_EXTERNAL_STORAGE");return null===t||1===t?t=1:c({content:"没有开启权限",confirmText:"设置",success:function(e){e.confirm&&O.gotoAppSetting()}}),t},clearImage(e,t){let a=-1;for(var i=0;i<this.fileDatas.length;i++){if(this.fileDatas[i].path==e.path){a=t;break}}this.imageDatas.splice(t,1),this.fileDatas.splice(a,1),this.$emit("filesChange",this.fileDatas)},clearDoc(e,t){let a=-1;for(var i=0;i<this.fileDatas.length;i++){if(this.fileDatas[i].path==e.path){a=t;break}}this.docDatas.splice(t,1),this.fileDatas.splice(a,1)},classify(){let e=[],t=[];for(var a=0;a<this.fileDatas.length;a++){const i=this.fileDatas[a];i.type&&i.type.includes("image")||i.type.includes("jpg")||i.type.includes("jpeg")||i.type.includes("png")?e.push(i):t.push(i)}this.imageDatas=e,this.docDatas=t,console.log(t)},previewFile(e){}}},[["render",function(e,t,a,i,s,o){const c=m,f=r,P=h("fileChooseItem"),O=F,T=p(d("u-icon"),g);return l(),n(f,null,{default:u((()=>[A(f,{class:"file-view u-m-t-10"},{default:u((()=>[(l(!0),y(b,null,C(s.imageDatas,((e,t)=>(l(),n(f,null,{default:u((()=>[A(f,{class:"file-item"},{default:u((()=>[A(c,{class:"preview-image",src:e.netPath?e.netPath:e.path,"data-src":e.netPath?e.netPath:e.path,mode:"aspectFill"},null,8,["src","data-src"]),A(c,{class:"clear-view",src:"data:image/png;base64,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",mode:"aspectFill",onClick:a=>o.clearImage(e,t)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),256)),s.fileDatas.length<9?(l(),n(P,{key:0,onFileChoosed:o.fileChoosed,ref:"fchoose"},null,8,["onFileChoosed"])):I("",!0)])),_:1}),s.docDatas.length>0?(l(),n(f,{key:0,class:"u-m-b-16"},{default:u((()=>[(l(!0),y(b,null,C(s.docDatas,((e,t)=>(l(),n(f,{key:t,onClick:t=>o.previewFile(e)},{default:u((()=>[A(f,{class:"doc-bg"},{default:u((()=>[A(c,{src:o.iconForFile(e),style:{width:"60rpx",height:"60rpx"}},null,8,["src"]),A(O,{class:"doc-text"},{default:u((()=>[v(S(e.name),1)])),_:2},1024),A(f,{onClick:E((a=>o.clearDoc(e,t)),["stop"])},{default:u((()=>[A(T,{name:"close",color:"#999999"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):I("",!0)])),_:1})}],["__scopeId","data-v-75f61708"]]);export{z as f};
