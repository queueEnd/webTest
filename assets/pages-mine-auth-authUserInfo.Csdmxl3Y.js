import{_ as e,R as t,bR as a,U as l,Q as o,bS as s,r as n,c as i,f as d,g as u,w as m,F as r,b as h,V as f,W as c,K as p,bu as g,o as b,k as _,i as M,t as y,j as C,q as w,p as k}from"./index-B3fvMXoi.js";import{_ as $}from"./z-paging.Ctbk3ePi.js";const v=e({props:{code:{type:String,default:null},tenantid:{type:String,default:null},tenantname:{type:String,default:""}},onReady(){this.$refs.uForm.setRules(this.formRules)},data:()=>({showModal:!1,submiting:!1,formModel:{idname:"",phone:""},formRules:{name:{type:"string",required:!0,message:"请输入身份证姓名",trigger:["blur"]},phone:[{required:!0,message:"请输入手机号",trigger:["change","blur"]},{validator:(e,t,a)=>uni.$u.test.mobile(t),message:"手机号码不正确",trigger:["change","blur"]}]}}),methods:{closeModal(){this.submiting||(this.showModal=!1)},submit(){this.$refs.uForm.validate().then((e=>{this.showModal=!0})).catch((e=>{}))},actionConfirm(){if(this.code){const e={idname:this.formModel.idname,phone:this.formModel.phone,invitecode:this.code};t({title:"正在提交...",mask:!0}),this.submiting=!0,a(e).then((e=>{this.submiting=!1,this.showModal=!1,l(),uni.$u.toast("已提交");this.getOpenerEventChannel().emit("inviteCodeAuthSubmit",{}),o({delta:2})})).catch((e=>{this.submiting=!1,this.showModal=!1,l(),e.data&&e.data.msg?uni.$u.toast(e.data.msg):uni.$u.toast("提交失败")}))}else if(this.tenantid){const e={idname:this.formModel.idname,phone:this.formModel.phone,tenantid:this.tenantid};t({title:"正在提交...",mask:!0}),this.submiting=!0,s(e).then((e=>{this.submiting=!1,this.showModal=!1,l(),uni.$u.toast("已提交申请，请耐心等待审核");this.getOpenerEventChannel().emit("authSubmit",{tenantid:this.tenantid}),o({delta:2})})).catch((e=>{this.submiting=!1,this.showModal=!1,l(),e.data&&e.data.msg?uni.$u.toast(e.data.msg):uni.$u.toast("提交失败")}))}}}},[["render",function(e,t,a,l,o,s){const v=w,x=n(i("u-input"),h),F=n(i("u-form-item"),f),S=n(i("u--form"),c),V=n(i("u-line"),p),R=n(i("z-paging"),$),z=k,B=n(i("u-modal"),g);return b(),d(r,null,[u(R,{style:{"background-color":"#F0F2F7"}},{bottom:m((()=>[u(v,{class:"u-p-b-60"},{default:m((()=>[u(V),u(v,{class:"u-m-t-20 z-mine-submit-btn",onClick:s.submit},{default:m((()=>[_("提交")])),_:1},8,["onClick"])])),_:1})])),default:m((()=>[u(v,null,{default:m((()=>[u(v,{class:"z-mine-setion",style:{padding:"26rpx 30rpx 0 30rpx"}},{default:m((()=>[u(v,{class:"z-mine-setion-title"},{default:m((()=>[_("设置个人信息")])),_:1}),u(S,{class:"u-p-t-12 u-p-b-12",ref:"uForm",model:o.formModel,labelPosition:"left",labelStyle:{"font-weight":500,color:"#292A2B"},labelWidth:"auto"},{default:m((()=>[u(F,{label:"手机号码",prop:"phone",borderBottom:""},{default:m((()=>[u(x,{modelValue:o.formModel.phone,"onUpdate:modelValue":t[0]||(t[0]=e=>o.formModel.phone=e),border:"none",placeholder:"请输入","input-align":"right",type:"number",clearable:""},null,8,["modelValue"])])),_:1}),u(F,{labelWidth:"auto",label:"真实姓名",prop:"idname",borderBottom:""},{default:m((()=>[u(x,{modelValue:o.formModel.idname,"onUpdate:modelValue":t[1]||(t[1]=e=>o.formModel.idname=e),border:"none",placeholder:"请输入","input-align":"right",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1}),u(B,{show:o.showModal,width:"600rpx",closeOnClickOverlay:!0,onConfirm:s.actionConfirm,onClose:s.closeModal,onCancel:s.closeModal,ref:"uModal",showCancelButton:!0,asyncClose:!0},{default:m((()=>[u(v,null,{default:m((()=>[u(v,{style:{"text-align":"center"}},{default:m((()=>[_("提示")])),_:1}),a.code?(b(),M(v,{key:0,class:"u-m-t-30"},{default:m((()=>[_("是否通过邀请码加入")])),_:1})):a.tenantid?(b(),M(v,{key:1,class:"u-m-t-30"},{default:m((()=>[_("是否申请加入"+y(a.tenantname),1)])),_:1})):C("",!0),u(v,null,{default:m((()=>[u(v,{class:"u-m-t-10"},{default:m((()=>[u(z,{style:{color:"#666E81"}},{default:m((()=>[_("手机号码：")])),_:1}),u(z,null,{default:m((()=>[_(y(o.formModel.phone),1)])),_:1})])),_:1}),u(v,{class:"u-m-t-10"},{default:m((()=>[u(z,{style:{color:"#666E81"}},{default:m((()=>[_("真实姓名：")])),_:1}),u(z,null,{default:m((()=>[_(y(o.formModel.idname),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","onConfirm","onClose","onCancel"])],64)}],["__scopeId","data-v-0a11b21e"]]);export{v as default};
