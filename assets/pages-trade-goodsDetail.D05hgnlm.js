import{_ as t,r as e,d as a,c as o,K as s,L as i,o as l,i as n,w as r,g as d,k as u,f as c,l as h,F as m,q as f,S as p,t as _,j as g,p as w,$ as y,O as S,R as D,n as x,aJ as k,T as b,V as C,s as Q,A as L,H as P,a_ as v,aX as A,y as I,m as z}from"./index-oXtcu1jG.js";import{_ as O}from"./uv-skeletons.Bd1_6wiO.js";import{_ as q}from"./z-paging.5yIaKEvz.js";import{b as j,l as B,m as T}from"./zhdnTradeApi.DtENn4FQ.js";import{p as $}from"./address-item.DzriXGz8.js";import G from"./pages-trade-components-trade-quotation.DwXtSAY_.js";/* empty css                                                                             */import{G as N}from"./zhdnGeneralApi.DMVLBSKg.js";import{o as F}from"./zhtuseful.CyewbK9i.js";import{g as R}from"./tradeConfig.Csb849zU.js";import{_ as W}from"./goods_detail.DaJ6WKyR.js";import{_ as H,a as M}from"./h_verify.DQ-bSO61.js";import"./form-item.eLhekq9H.js";import"./form-item-input.u4fUP3sq.js";const U=t({components:{pAddressItem:$,tradeQuotation:G,tradeGoodsPlans:t({emits:["close","confirm"],props:{show:{type:Boolean,default:!1},data:{type:Object,default:{userDesignedContainerInfo:[]}},oldWeight:{type:String,default:""}},watch:{show:{handler(){this.popShow=this.show},immediate:!0},data:{handler(){if(this.data&&this.data.id){var t="";t+='<span style="font-weight: bold;">预估装载方案测算：</span>',"吨"==this.data.goodWeightUnit?t+=`<span style="font-weight: 500;">以上装载重量≥${this.data.goodWeight}吨。</span>`:"箱"==this.data.goodWeightUnit&&(t+=`<span style="font-weight: 500;">总需求${this.data.goodWeight}箱。</span>`),this.data.userDesignedContainerInfo.forEach((e=>{if(1==e.type)e.containerInfo.forEach((e=>{e.load||(e.load=Number(e.productWeight)),t+=`<span>单箱方案${e.product}*${e.productNum}预估合计装载${e.load*e.productNum}吨</span>，`}));else if(2==e.type){let a="",o=0;e.containerInfo.forEach((t=>{t.load||(t.load=Number(t.productWeight)),t.productNum>0&&(a.length>0&&(a+="+"),a=a+t.product+"*"+t.productNum,o+=t.productNum*t.load)})),t+=`<span>组合方案${a}预估合计装载${o}吨</span>，`}})),this.boxConfigHtml=t}},immediate:!0}},data:()=>({popShow:!1,boxConfigHtml:"预估装载方案测算："}),methods:{closePop(){this.$emit("close")},confirmAction(){this.$emit("confirm",this.loadWeight)}}},[["render",function(t,y,S,D,x,k){const b=f,C=e(o("u-icon"),a),Q=w,L=p,P=e(o("u-line"),s),v=e(o("u-popup"),i);return l(),n(v,{show:x.popShow,round:12,mode:"bottom",onClose:k.closePop},{default:r((()=>[d(b,null,{default:r((()=>[d(b,{class:"u-flex u-flex-items-center",style:{margin:"30rpx 30rpx 0 30rpx","justify-content":"space-between"}},{default:r((()=>[d(b,{style:{"font-size":"30rpx","font-weight":"500",color:"#272e3f"}},{default:r((()=>[u("预选方案")])),_:1}),d(b,{style:{width:"120rpx","font-size":"23rpx",display:"flex","justify-content":"flex-end"},onClick:k.closePop},{default:r((()=>[d(C,{name:"close"})])),_:1},8,["onClick"])])),_:1}),d(L,{"scroll-y":"",style:{"max-height":"840rpx"}},{default:r((()=>[d(b,{class:"u-p-l-30 u-p-r-30"},{default:r((()=>[(l(!0),c(m,null,h(S.data.userDesignedContainerInfo,((t,e)=>(l(),n(b,{key:e},{default:r((()=>[1==t.type?(l(),n(b,{key:0,class:"u-m-t-30",style:{"font-size":"28rpx",color:"#292A2B"}},{default:r((()=>[u("单箱型方案【"+_(t.containerInfo[0].product)+"】 ",1)])),_:2},1024)):g("",!0),d(b,{style:{"margin-top":"24rpx",background:"#f4f4f4","border-radius":"8px",padding:"24rpx 30rpx"}},{default:r((()=>[(l(!0),c(m,null,h(t.containerInfo,((t,e)=>(l(),n(b,{key:e},{default:r((()=>[d(b,null,{default:r((()=>[u(_(t.product),1)])),_:2},1024),d(b,{class:"u-flex u-flex-items-center u-flex-between"},{default:r((()=>[d(b,null,{default:r((()=>[d(Q,{style:{color:"#666e81","font-size":"24rpx"}},{default:r((()=>[u("预计装载量:")])),_:1}),d(Q,{style:{color:"#292a2b","font-size":"24rpx","font-weight":"500"}},{default:r((()=>[u(_(t.productWeight)+"吨",1)])),_:2},1024)])),_:2},1024),d(b,{style:{color:"#292a2b","font-size":"30rpx"}},{default:r((()=>[u("x"+_(t.productNum),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1}),d(b,{class:"u-m-t-24 u-m-l-30 u-m-r-30",innerHTML:x.boxConfigHtml,style:{color:"#666E81","font-size":"24rpx"}},null,8,["innerHTML"])])),_:1}),d(P,{class:"u-m-t-30"}),d(b,{style:{padding:"20rpx 30rpx 40rpx 30rpx"}},{default:r((()=>[d(b,{style:{"line-height":"78rpx","font-size":"28rpx","font-weight":"500","text-align":"center","border-radius":"4px","background-color":"#2647FF",color:"#fff"},onClick:k.closePop},{default:r((()=>[u("我知道了")])),_:1},8,["onClick"])])),_:1}),d(b,{style:{height:"10rpx"}})])),_:1})])),_:1},8,["show","onClose"])}]])},data:()=>({id:null,loading:!1,skeleton:F.detailSkeleton,itemData:null,quotationLimitTime:0,timeData:{},badgeData:null,toolState:{show:!1,showMore:!1,showOnlineQuote:!1,showServiceQuote:!1,showAIQuote:!1,showSupllyQuote:!1,showOrder:!1},showQuotationPop:!1,actionList:[],actionListShow:!1,boxPlanShow:!1}),onLoad(t){y("tradeGoodsDetail-refresh",(t=>{this.onRefresh()})),t.id&&(this.id=t.id,this.loadDetailData())},onUnload(){S("tradeGoodsDetail-refresh")},watch:{itemData:{handler(){if(this.itemData)switch(R(this.itemData),this.toolState.show=!1,this.toolState.showMore=!1,this.toolState.showOnlineQuote=!1,this.toolState.showServiceQuote=!1,this.toolState.showAIQuote=!1,this.toolState.showSupllyQuote=!1,this.itemData.isValid){case 1:case 2:this.toolState.show=!0,this.itemData.isCreateBySelf?(this.toolState.show=!0,this.toolState.showMore=!0,this.toolState.showOnlineQuote=!0,this.toolState.showServiceQuote=!0,this.toolState.showAIQuote=!0,this.toolState.showSupllyQuote=!1):(this.toolState.showMore=!0,this.itemData.sendPriceList.length>0?(this.toolState.showOnlineQuote=!0,this.toolState.showSupllyQuote=!0):this.toolState.showSupllyQuote=!0);break;case 3:this.toolState.show=!0,this.itemData.isCreateBySelf?(this.toolState.showOrder=!0,this.toolState.showOnlineQuote=!0):this.itemData.sendPriceList.length>0&&(this.toolState.showOnlineQuote=!0);break;case 4:this.toolState.show=!1,this.itemData.sendPriceList.length>0?(this.toolState.show=!0,this.toolState.showOnlineQuote=!0):this.toolState.show=!1;break;case 5:this.toolState.show=!1}},immediate:!0}},methods:{goBack(){D()},onChange(t){this.timeData=t},onRefresh(){this.id&&(this.loadDetailData(),this.loadQuotationPlanBadge())},loadDetailData(){this.loading=!0,j(this.id).then((t=>{this.loading=!1,this.itemData=t.data,this.$refs.paging.complete()})).catch((t=>{this.loading=!1}))},limitTimeChange(t){this.timeData=t},supplierToQuote(){this.itemData.sendPriceList.length>0?this.showQuotationPlan():x({url:"/pages/trade/tradeFirstQuote?id="+this.id,events:{quoteSuccess:function(t){}}})},quotationSuccess(){this.showQuotationPop=!1,this.loadDetailData()},supplierQuotationDetail(){this.itemData.quoteDetail&&x({url:"/pages/trade/quotationDetail?id="+this.itemData.quoteDetail.id})},moreAction(){this.itemData.isCreateBySelf&&(this.actionList=[{name:"下架",color:"#dd524d",fontSize:"30rpx"}],this.actionListShow=!0)},actionListClick(t){if("下架"==t.name){let t=this;k({title:"提示",content:"是否下架？",confirmColor:"#2647FF",success:function(e){e.confirm?t.apiDownGoods():e.cancel}})}this.actionListShow=!1},actionListShowChange(t){this.actionListShow=t},apiTest(){N().then((t=>{})).catch((t=>{}))},apiDownGoods(){b({title:"正在下架...",mask:!0}),B(this.itemData.id).then((t=>{C(),200==t.code?(this.loadDetailData(),Q({icon:"none",title:"已下架"})):(C(),Q({icon:"none",title:err.msg?err.msg:"删除失败"}))})).catch((t=>{C();Q({icon:"none",title:"下架失败"})}))},loadQuotationPlanBadge(){T(this.id,0).then((t=>{this.badgeData=t.data})).catch((t=>{}))},showQuotationPlan(){this.itemData.isCreateBySelf?x({url:"/pages/trade/quotationPage?id="+this.id}):x({url:"/pages/trade/quotationPage?type=1&id="+this.id})},goCreateOrder(){this.itemData.isCreateBySelf&&3==this.itemData.isValid&&x({url:"/pages/smart/orderInput?source=1&id="+this.itemData.id})},goAIQuote(){x({url:"/pages/trade/tradeAIQuote?id="+this.itemData.id})}}},[["render",function(t,i,p,y,S,D){const x=e(o("u-status-bar"),P),k=e(o("u-icon"),a),b=f,C=w,Q=e(o("u-empty"),v),j=z,B=L("up-count-down"),T=L("pAddressItem"),$=(e(o("u-line"),s),e(o("uv-skeletons"),O)),G=L("up-badge"),N=e(o("z-paging"),q),F=e(o("u-action-sheet"),A),R=L("tradeQuotation"),H=L("tradeGoodsPlans");return l(),c(m,null,[d(N,{ref:"paging",style:{"background-color":"#f0f2f7"},"refresher-only":"",onOnRefresh:D.onRefresh},{top:r((()=>[d(b,{class:"u-flex-col",style:{"background-color":"#2c5eff"}},{default:r((()=>[d(x),d(b,{class:"rd-custom-nav"},{default:r((()=>[d(b,{class:"nav-back-bg",onClick:D.goBack},{default:r((()=>[d(k,{name:"arrow-left",color:"white",size:"18"})])),_:1},8,["onClick"]),d(b,{class:"nav-title"},{default:r((()=>[u("货源详情")])),_:1}),d(b,{style:{height:"100%"}})])),_:1})])),_:1})])),bottom:r((()=>[S.toolState.show?(l(),n(b,{key:0,class:"rd-bottom"},{default:r((()=>[S.itemData.isCreateBySelf?(l(),n(b,{key:0,onClick:D.moreAction},{default:r((()=>[S.toolState.showMore?(l(),n(k,{key:0,label:"更多","label-pos":"bottom","label-size":"20rpx",name:"more-circle",size:"32rpx",color:"#333333","label-color":"#333333"})):g("",!0)])),_:1},8,["onClick"])):g("",!0),d(b,{style:{flex:"1"}}),S.toolState.showOnlineQuote?(l(),n(b,{key:1,class:"rd-bottom__btnGray",onClick:D.showQuotationPlan},{default:r((()=>[d(C,null,{default:r((()=>[u("报价方案")])),_:1}),S.badgeData?(l(),n(G,{key:0,style:{top:"-8rpx",right:"-12rpx"},absolute:!0,bgColor:"#FF0003",max:"99",value:S.badgeData.onlinePriceNum},null,8,["value"])):g("",!0)])),_:1},8,["onClick"])):g("",!0),S.toolState.showServiceQuote?(l(),n(b,{key:2,class:"rd-bottom__btnGray"},{default:r((()=>[u("客服报价")])),_:1})):g("",!0),S.toolState.showAIQuote?(l(),n(b,{key:3,class:"rd-bottom__btnBlue",onClick:D.goAIQuote},{default:r((()=>[u("AI报价")])),_:1},8,["onClick"])):g("",!0),S.toolState.showOrder?(l(),n(b,{key:4,class:"rd-bottom__btnBlue",onClick:D.goCreateOrder},{default:r((()=>[u("在线下单")])),_:1},8,["onClick"])):g("",!0),S.toolState.showSupllyQuote?(l(),n(b,{key:5,class:"rd-bottom__btnBlue",onClick:D.supplierToQuote},{default:r((()=>[u("在线报价")])),_:1},8,["onClick"])):g("",!0)])),_:1})):g("",!0)])),default:r((()=>[d(b,{class:"rd-gradient-bg"}),d($,{skeleton:S.skeleton,animate:!0,loading:S.loading,style:{padding:"0 0 80rpx 0"}},{default:r((()=>[d(Q,{style:{"margin-top":"200rpx"},show:!S.itemData&&!S.loading,icon:"/static/image/common/empty.png",width:"200rpx",height:"200rpx",text:" "},{default:r((()=>[d(b,{style:{display:"flex","flex-direction":"column","align-items":"center"}},{default:r((()=>[d(C,{style:{color:"#fff"}},{default:r((()=>[u("暂无相关数据")])),_:1}),d(C,{style:{color:"#999999","margin-top":"10rpx","font-size":"24rpx"}})])),_:1})])),_:1},8,["show"]),S.itemData?(l(),n(b,{key:0},{default:r((()=>[d(b,{class:"rd-section-bg"},{default:r((()=>[d(j,{class:"rd-one-logo",src:W}),d(b,{class:"rd-one-top"},{default:r((()=>[d(b,{class:"rd-one-top__title"},{default:r((()=>[u("意向价格/吨")])),_:1}),d(b,{class:"rd-one-top__status",style:I({"background-color":S.itemData.statusColor})},{default:r((()=>[u(_(S.itemData.statusText),1)])),_:1},8,["style"])])),_:1}),d(b,{class:"rd-one-price"},{default:r((()=>[d(C,{class:"rd-one-price__unit"},{default:r((()=>[u("¥")])),_:1}),d(C,{class:"rd-one-price__value"},{default:r((()=>[u(_(S.itemData.intentionPrice),1)])),_:1})])),_:1}),d(b,{class:"rd-one-tiem"},{default:r((()=>[d(b,{class:"rd-one-tiem__title"},{default:r((()=>[u(_(S.quotationLimitTime>0?"距报价结束":"报价已结束"),1)])),_:1}),S.quotationLimitTime>0?(l(),n(B,{key:0,time:S.quotationLimitTime,format:"HH:mm:ss",autoStart:"",millisecond:"",onChange:D.limitTimeChange},{default:r((()=>[d(b,{class:"tradeLimit-p"},{default:r((()=>[S.timeData.days&&S.timeData.days>0?(l(),n(b,{key:0,class:"tradeLimit-p_day"},{default:r((()=>[u(_(S.timeData.days),1)])),_:1})):g("",!0),S.timeData.days&&S.timeData.days>0?(l(),n(C,{key:1,class:"tradeLimit-p_dayunit"},{default:r((()=>[u("天")])),_:1})):g("",!0),d(b,{class:"tradeLimit-p_item"},{default:r((()=>[u(_(S.timeData.hours>10?S.timeData.hours:"0"+S.timeData.hours),1)])),_:1}),d(C,{class:"tradeLimit-p_doc"},{default:r((()=>[u(":")])),_:1}),d(b,{class:"tradeLimit-p_item"},{default:r((()=>[u(_(String(S.timeData.minutes).padStart(2,"0")),1)])),_:1}),d(C,{class:"tradeLimit-p_doc"},{default:r((()=>[u(":")])),_:1}),d(b,{class:"tradeLimit-p_item"},{default:r((()=>[u(_(String(S.timeData.seconds).padStart(2,"0")),1)])),_:1})])),_:1})])),_:1},8,["time","onChange"])):g("",!0)])),_:1})])),_:1}),d(b,{class:"rd-section-bg"},{default:r((()=>[d(T,{canChoose:!1,startAddress:S.itemData.startAddressItem,endAddress:S.itemData.endAddressItem},null,8,["startAddress","endAddress"]),g("",!0),g("",!0)])),_:1}),d(b,{class:"rd-section-bg rd-three"},{default:r((()=>[d(b,{class:"rd-three__title"},{default:r((()=>[u("货源信息")])),_:1}),""!=S.itemData.serviceReq||S.itemData.files.length>0?(l(),n(b,{key:0,class:"rd-three__file"},{default:r((()=>[d(b,{class:"rd-three__file__info"},{default:r((()=>[u(_(S.itemData.serviceReq),1)])),_:1}),(l(!0),c(m,null,h(S.itemData.files,((t,e)=>(l(),n(b,{key:e,class:"u-flex u-flex-items-center u-m-t-20"},{default:r((()=>[d(k,{name:"file-text",size:"30rpx"}),d(C,{class:"rd-three__file__name"},{default:r((()=>[u(_(t.fileName),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):g("",!0),(l(!0),c(m,null,h(S.itemData.goodsInfoArr,((t,e)=>(l(),n(b,{key:e},{default:r((()=>["02"!=S.itemData.source&&"预选装载方案"==t.title?(l(),n(b,{key:0,class:"u-flex u-flex-items-center u-m-t-20",style:{padding:"0 26rpx",background:"#f6ece2","border-radius":"8px",height:"60rpx"},onClick:i[0]||(i[0]=t=>S.boxPlanShow=!0)},{default:r((()=>[d(k,{name:"info-circle",size:"14",color:"#846651"}),d(C,{style:{flex:"1","margin-left":"12rpx",color:"#846651","font-size":"24rpx"}},{default:r((()=>[u("预选装载方案")])),_:1}),d(C,{style:{color:"#5F3C24","font-size":"24rpx","font-weight":"500"}},{default:r((()=>[u("已选择"+_(S.itemData.userDesignedContainerInfo.length)+"种方案",1)])),_:1}),d(k,{class:"u-m-l-16",name:"arrow-right",size:"10",color:"#846651"})])),_:1})):"预选装载方案"!=t.title?(l(),n(b,{key:1,class:"rd-three-item"},{default:r((()=>[d(b,{class:"rd-three-item__title"},{default:r((()=>[u(_(t.title),1)])),_:2},1024),d(b,{class:"rd-three-item__value"},{default:r((()=>[u(_(t.value),1)])),_:2},1024)])),_:2},1024)):g("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})):g("",!0)])),_:1},8,["skeleton","loading"])])),_:1},8,["onOnRefresh"]),d(F,{actions:S.actionList,show:S.actionListShow,"onUpdate:show":D.actionListShowChange,closeOnClickOverlay:!0,closeOnClickAction:!0,cancelText:"取消",onSelect:D.actionListClick},null,8,["actions","show","onUpdate:show","onSelect"]),S.itemData?(l(),n(R,{key:0,show:S.showQuotationPop,type:0,id:this.id,newPrice:S.itemData.intentionPrice,quotationInfo:S.itemData.quoteDetail,closeOnClickOverlay:!0,onClose:i[1]||(i[1]=t=>S.showQuotationPop=!1),onSuccess:D.quotationSuccess},null,8,["show","id","newPrice","quotationInfo","onSuccess"])):g("",!0),d(H,{show:S.boxPlanShow,data:S.itemData,onClose:i[2]||(i[2]=t=>S.boxPlanShow=!1),onConfirm:i[3]||(i[3]=t=>S.boxPlanShow=!1)},null,8,["show","data"])],64)}],["__scopeId","data-v-ad197f49"]]);export{U as default};
