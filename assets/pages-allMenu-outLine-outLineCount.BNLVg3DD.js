import{_ as t,ak as e,n as i,cG as n,s,R as a,U as o,r as l,c as r,f as p,g as h,w as c,F as d,ab as u,q as f,a7 as g,d as m,o as x,ah as _,y as w,k as b,t as C,l as y,p as k,S as M,i as A}from"./index-B3fvMXoi.js";import{_ as S}from"./l-floating-panel.Dh4psWJI.js";import{b as L,c as z,a as F}from"./webApi.Ds-2Cs1x.js";import{b as B,c as j}from"./pythonApi.kJLAZc7b.js";import{A as I}from"./AmapUtil.CIrCVBrz.js";import"./constants.mpH2PV74.js";const P=t({data(){const{windowHeight:t}=e();return{windowHeight:t,anchors:[50,Math.round(.4*t),Math.round(.8*t)],map:null,listCount:[],list:[],listBorderStation:[],listStation:[],listLine:[],listCnLine:[]}},onLoad(t){this.getCount(),this.getBorderStation(),this.getStation(),this.getLine()},mounted(){I.createInstance()},methods:{search(t){if(0==t.length)return void(this.listCount=this.list);let e=[];for(let i of this.list)i.blpp.includes(t)&&e.push(i);this.listCount=e},check(t){i({url:"/pages/allMenu/outLine/outLineDetail?line="+t})},initMap(){null==this.map&&(this.map=new AMap.Map("container",{viewMode:"2D"}))},getCount(){n().then((t=>{0!=t.length?(this.list=t.data,this.listCount=t.data):s({title:"班列信息为空",icon:"error"})}))},getBorderStation(){B().then((t=>{this.listBorderStation=t.data,this.listBorderStation.length>0&&setTimeout((()=>{this.initBorderPoints()}),200)}))},initBorderPoints(){this.initMap();for(let t of this.listBorderStation){let e=new AMap.Marker({map:this.map,position:[t.lon,t.lat],icon:new AMap.Icon({image:"/static/image/menu/icon_border_point.png",imageSize:new AMap.Size(15,15)}),zIndex:100});e.content=t.hzzm,e.on("click",this.addClick)}this.map.setFitView()},getStation(){L().then((t=>{this.listStation=t.features,this.listStation.length>0&&setTimeout((()=>{this.initPoints()}),200)}))},initPoints(){this.initMap();for(let t of this.listStation){let e=new AMap.Marker({map:this.map,position:t.geometry.coordinates,icon:new AMap.Icon({image:"/static/image/menu/icon_cn_point.png",imageSize:new AMap.Size(10,10)})});e.content=t.properties.name,e.on("click",this.addClick)}this.map.setFitView()},getLine(){z().then((t=>{this.listLine=t.features,this.listLine.length>0&&setTimeout((()=>{this.initLine()}),200)}))},initLine(){this.initMap();for(let t of this.listLine){let e=new AMap.Polyline({path:t.geometry.coordinates,strokeColor:`#${Math.floor(16777215*Math.random()).toString(16)}`,strokeWeight:1,strokeOpacity:1,lineCap:"round",zIndex:50});this.map.add(e)}this.map.setFitView()},getCnLine(){F().then((t=>{this.listCnLine=t.features,this.listCnLine.length>0&&setTimeout((()=>{this.initCnLine()}),200)}))},initCnLine(){this.initMap();for(let t of this.listCnLine){let e=new AMap.Polyline({path:t.geometry.coordinates,strokeColor:"#D7D7D7",strokeWeight:1,strokeOpacity:1,lineCap:"round",zIndex:50});this.map.add(e)}this.map.setFitView()},addClick(t){a({title:"查询中"}),j(t.target.content).then((e=>{if("ok"==e.msg){var i=[];i.push(`<p class='text_black_16'>${e.info.label2}</p>`),i.push(`<p class='text_gray_12'>位置：${e.info.city+e.info.qxmc}</p>`),i.push(`<p class='text_gray_12'>路局：${e.info.ljqc}</p>`),i.push("<p class='text_blue_12'>查看详情</p>"),new AMap.InfoWindow({content:i.join(""),anchor:"bottom-center"}).open(this.map,t.target.getPosition())}else s({title:"没有数据",icon:"error"})})).catch((t=>{s({title:"没有数据",icon:"error"})})).finally((t=>{o()}))}},onPageScroll(t){t.scrollTop>400?this.bgColor="white":this.bgColor="transparent"}},[["render",function(t,e,i,n,s,a){const o=l(r("u-navbar"),u),L=f,z=l(r("u-search"),g),F=k,B=l(r("u-icon"),m),j=M,I=l(r("l-floating-panel"),S);return x(),p(d,null,[h(L,{class:"u-flex-column"},{default:c((()=>[h(o,{borderBottom:!1,bgColor:"transparent",title:"跨境班列"}),_("div",{id:"container",class:"map",style:w([{width:"100%"},"height:"+s.windowHeight+"px"])},null,4)])),_:1}),h(I,{anchors:s.anchors,defaultAnchor:1},{default:c((()=>[h(L,{class:"u-flex-column",style:{padding:"30rpx"}},{default:c((()=>[h(z,{showAction:!1,placeholder:"请输入班列名称进行查询",onChange:a.search},null,8,["onChange"]),h(F,{style:{"font-size":"28rpx",color:"#272E3F","margin-top":"30rpx","font-weight":"bold"}},{default:c((()=>[b(" 班列统计 ")])),_:1}),h(L,{class:"u-flex u-m-t-20"},{default:c((()=>[h(F,{style:{"font-size":"24rpx",color:"#292A2B"}},{default:c((()=>[b(" 国际 ")])),_:1}),h(F,{style:{"font-size":"24rpx",color:"#FAAD14","margin-left":"10rpx"}},{default:c((()=>[b(C(s.list.length),1)])),_:1})])),_:1}),h(j,{"scroll-y":"",style:w([{"margin-top":"20rpx"},"height:"+(s.anchors[2]-180)+"px"])},{default:c((()=>[(x(!0),p(d,null,y(s.listCount,((t,e)=>(x(),A(L,{key:e,class:"u-flex u-flex-between u-flex-items-center",style:{background:"#f8f9fd","border-radius":"8px",padding:"32rpx 24rpx","margin-top":"20rpx"}},{default:c((()=>[h(B,{style:{flex:"1"},name:"/static/image/share/icon_station_blue.png",size:"18",label:e+1+"."+t.blpp,"label-color":"#272E3F","label-size":"13",space:"10"},null,8,["label"]),h(L,{class:"u-flex u-m-l-20 u-m-r-40"},{default:c((()=>[h(F,{style:{"font-size":"28rpx",color:"#666E81"}},{default:c((()=>[b(" 通道数量： ")])),_:1}),h(F,{style:{"font-size":"28rpx",color:"#2647FF"}},{default:c((()=>[b(C(t.count),1)])),_:2},1024)])),_:2},1024),h(F,{style:{background:"white",border:"0.5px solid #2647ff","border-radius":"4px","font-size":"24rpx",color:"#2647FF",padding:"12rpx 24rpx"},onClick:e=>a.check(t.blpp)},{default:c((()=>[b(" 查看 ")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1},8,["style"])])),_:1})])),_:1},8,["anchors"])],64)}],["__scopeId","data-v-a5309de5"]]);export{P as default};
