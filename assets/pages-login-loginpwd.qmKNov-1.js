import{_ as e,R as t,Q as o,n as l,T as a,a5 as s,a0 as n,V as r,s as i,a1 as d,a6 as u,r as c,c as m,i as f,w as p,H as g,d as h,K as x,b as _,W as w,X as b,o as k,g as y,k as I,q as L,p as M,m as z}from"./index-FwbBwjbJ.js";import{_ as C}from"./z-paging.B7jAqyNm.js";import{m as V}from"./md5.6s00qotZ.js";import{_ as v}from"./login-wechat.BcCbROG6.js";const A=e({data:()=>({formRules:{phone:[{required:!0,message:"请输入手机号",trigger:["change","blur"]},{validator:(e,t,o)=>uni.$u.test.mobile(t),message:"手机号码不正确",trigger:["change","blur"]}],password:[{required:!0,message:"请输入密码",trigger:["change","blur"]}]},formModel:{phone:"",password:""}}),methods:{goBack(){t()},switchPhoneLogin(){for(var e=o(),a=0;a<e.length;a++){if("/pages/login/login"==e[a].route)return void t()}l({url:"/pages/login/login"})},loginAction(){this.$refs.uForm.validate().then((e=>{this.toApiLogin()})).catch((e=>{}))},toApiLogin(){a({title:"正在登录..."}),s(this.formModel.phone,V.md5(this.formModel.password)).then((e=>{e.tenantInfoList&&e.tenantInfoList.length>1?this.apiSwitchTenant(e):e.access_token?(n.commit("login",e),r(),i({icon:"none",title:"登录成功"}),d({url:"/pages/index/index"})):e.msg?(r(),i({icon:"error",title:e.msg})):uni.$u.toast("登录失败")})).catch((e=>{r(),i({icon:"error",title:"登录失败"})}))},apiSwitchTenant(e){for(var t=e.tenantInfoList[0].tenantId,o=0;o<e.tenantInfoList.length;o++){const l=e.tenantInfoList[o];if("781155"==l.tenantId){t=l.tenantId;break}}const l=e.refresh_token;u(t,l).then((e=>{n.commit("login",e),r(),i({icon:"none",title:"登录成功"}),d({url:"/pages/index/index"})})).catch((e=>{r(),i({icon:"error",title:"登录失败"})}))}}},[["render",function(e,t,o,l,a,s){const n=c(m("u-status-bar"),g),r=c(m("u-icon"),h),i=L,d=M,u=c(m("u-line"),x),V=c(m("u-input"),_),A=c(m("u-form-item"),w),F=c(m("u--form"),b),j=z,B=c(m("z-paging"),C);return k(),f(B,null,{bottom:p((()=>[y(i,{class:"u-p-b-60",style:{display:"flex","flex-direction":"column","align-items":"center"}},{default:p((()=>[y(i,{class:"u-flex u-flex-items-center"},{default:p((()=>[y(u,{length:"224rpx"}),y(d,{style:{"font-size":"24rpx",color:"#666e81",margin:"0 20rpx"}},{default:p((()=>[I("其他登录方式")])),_:1}),y(u,{length:"224rpx"})])),_:1}),y(i,{class:"u-m-t-40"},{default:p((()=>[y(j,{src:v,style:{width:"72rpx",height:"72rpx"}})])),_:1})])),_:1})])),default:p((()=>[y(i,null,{default:p((()=>[y(n),y(i,{class:"u-flex-y-center u-p-l-30",style:{width:"200rpx",height:"100rpx"},onClick:s.goBack},{default:p((()=>[y(r,{name:"close",color:"#292A2B",size:"20"})])),_:1},8,["onClick"])])),_:1}),y(i,{class:"u-m-t-30 u-margin-center-auto",style:{width:"600rpx"}},{default:p((()=>[y(i,{class:"l-title"},{default:p((()=>[I("密码登录")])),_:1}),y(F,{ref:"uForm",style:{"margin-top":"80rpx"},rules:a.formRules,model:a.formModel},{default:p((()=>[y(A,{prop:"phone"},{default:p((()=>[y(V,{modelValue:a.formModel.phone,"onUpdate:modelValue":t[0]||(t[0]=e=>a.formModel.phone=e),placeholder:"请输入手机号码",border:"bottom",type:"number"},{prefix:p((()=>[y(i,{class:"u-flex u-flex-items-center"},{default:p((()=>[y(d,{class:"l-area-code",slot:"prefix"},{default:p((()=>[I("+86")])),_:1}),y(r,{class:"u-m-l-16",name:"arrow-down-fill",size:"8",color:"#292A2B"}),y(u,{class:"u-m-l-16 u-m-r-6",direction:"col",length:"32rpx",color:"#E1E2E6"})])),_:1})])),_:1},8,["modelValue"])])),_:1}),y(A,{prop:"password"},{default:p((()=>[y(V,{modelValue:a.formModel.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.formModel.password=e),placeholder:"请输入密码",border:"bottom",type:"password"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"]),y(i,{class:"login-sendCode",onClick:s.loginAction},{default:p((()=>[I(" 登录 ")])),_:1},8,["onClick"]),y(i,{class:"login-byPwd",onClick:s.switchPhoneLogin},{default:p((()=>[I(" 短信验证码登录 ")])),_:1},8,["onClick"]),y(i,{class:"u-m-t-30 u-flex u-flex-items-center",style:{"font-size":"24rpx",color:"#2647FF"}},{default:p((()=>[y(r,{name:"checkmark-circle",color:"#2647FF",size:"16"}),y(d,{class:"u-m-l-10",style:{color:"#999999"}},{default:p((()=>[I("我已阅读并同意")])),_:1}),y(d,null,{default:p((()=>[I("《用户使用协议》")])),_:1}),y(d,null,{default:p((()=>[I("《隐私政策》")])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-b632b144"]]);export{A as default};
