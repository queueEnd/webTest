import{_ as e,bN as l,bO as a,T as o,U as t,V as s,s as n,bo as i,aV as r,aU as d,bP as u,R as m,r as f,c as p,A as c,f as g,g as h,w as y,F as b,b as _,W as x,aL as C,aM as M,a4 as F,X as V,d as k,K as w,bw as z,o as I,k as N,l as B,i as T,j as q,t as S,q as U,p as W}from"./index-FwbBwjbJ.js";import{_ as A}from"./uv-skeletons.X_8W0G2D.js";import{_ as E}from"./z-paging.B7jAqyNm.js";import{f as v}from"./file-choose.Cjz2o6D5.js";import{f as D}from"./FileUtil.DUlOPnx-.js";import{o as L}from"./zhtuseful.CyewbK9i.js";const R=e({components:{fileChoose:v},onReady(){this.$refs.uForm.setRules(this.formRules)},data:()=>({formModel:{comName:"",comLicenseNum:"",legalIdname:"",legalIdcard:"",idname:"",phone:"",smscode:"",manageVerifyWay:"将法定代表人设置为管理员",useropr:{company:"",idcard:"",idname:"",phone:"",smscode:""}},formRules:{comName:{type:"string",required:!0,message:"请输入企业名称",trigger:["blur"]},comLicenseNum:{type:"string",required:!0,message:"营业执照注册号",trigger:["blur"]},legalIdname:{type:"string",required:!0,message:"请输入法人身份证姓名",trigger:["blur"]},legalIdcard:{type:"string",required:!0,message:"请输入法人身份证号码",trigger:["blur"]},"useropr.idname":{type:"string",required:!0,message:"请输入管理员身份证姓名",trigger:["blur"]},"useropr.idcard":{type:"string",required:!0,message:"请输入管理员身份证号码",trigger:["blur"]},"useropr.phone":[{required:!0,message:"请输入手机号",trigger:["change","blur"]},{validator:(e,l,a)=>uni.$u.test.mobile(l),message:"手机号码不正确",trigger:["change","blur"]}],"useropr.smscode":{type:"string",required:!0,message:"请输入验证码",trigger:["blur"]}},canSend:!0,codeText:"",showModal:!1,loading:!1,skeleton:L.listSkeleton,fileDatasCer:[],uploadedFilesCer:[],uploadStatusCer:[],editFilesCer:[],fileDatas:[],uploadedFiles:[],uploadStatus:[],editFiles:[],manageVerifyWayList:[{name:"将法定代表人设置为管理员"},{name:"设置其他人为管理员"}],payInfo:null,smsKey:"",submiting:!1}),onLoad(){this.loadAuthInfo()},methods:{fileChange(e){this.fileDatas=e},fileChangeCer(e){this.fileDatasCer=e},closeModal(){this.submiting||(this.showModal=!1)},manageWayRadioChange(e){console.log(e),this.$refs.uForm.setRules(this.formRules)},loadAuthInfo(){this.loading=!0,l().then((e=>{this.loading=!1,this.payInfo=e.data})).catch((e=>{this.loading=!1}))},copyText(e){a({data:e,success:function(){uni.$u.toast("已复制到剪贴板")},fail:function(){uni.$u.toast("复制失败")}})},toApiSMSCode(){this.formModel.useropr.phone.length<10?uni.$u.toast("请输入手机号码"):(o({title:"正在发送...",mask:!0}),t(this.formModel.useropr.phone).then((e=>{e.data.code&&(s(),n({icon:"none",title:"验证码已发送"}),this.smsKey=e.data.code)})).catch((e=>{s(),uni.$u.toast("发送失败")})))},downLoadTempFile(){D.previewFile(i+"/blade-smartai/authopr/downloadTemplate")},submit(){this.$refs.uForm.validate().then((e=>{0!=this.fileDatasCer.length?(console.log(this.formModel),this.showModal=!0):uni.$u.toast("请上传授权书")})).catch((e=>{console.log(this.formModel)}))},async actionConfirm(){if(this.submiting=!0,await r(this.fileDatas,this.uploadedFiles,this.uploadStatus),this.uploadStatus.includes("fail"))return n({title:"部分文件上传失败，请重试",icon:"none"}),this.submiting=!1,void(this.showModal=!1);if(await r(this.fileDatasCer,this.uploadedFilesCer,this.uploadStatusCer),this.uploadStatusCer.includes("fail"))return n({title:"部分文件上传失败，请重试",icon:"none"}),this.submiting=!1,void(this.showModal=!1);const e=[];for(let o=0;o<this.fileDatasCer.length;o++){const l=this.fileDatasCer[o];let a={fileName:l.netName?l.netName:"",fileUrl:l.netPath?l.netPath:"",fileType:l.netType?l.netType:"",type:2};e.push(a)}const l=[];for(let o=0;o<this.fileDatas.length;o++){const e=this.fileDatas[o];let a={fileName:e.netName?e.netName:"",fileUrl:e.netPath?e.netPath:"",fileType:e.netType?e.netType:"",type:1};l.push(a)}const a=d(this.formModel);a.files=e,a.payFiles=l,u(a,this.smsKey).then((e=>{this.submiting=!1,this.showModal=!1,uni.$u.toast("已提交");this.getOpenerEventChannel().emit("authSubmit",{}),m()})).catch((e=>{this.submiting=!1,this.showModal=!1,uni.$u.toast("提交失败")}))}}},[["render",function(e,l,a,o,t,s){const n=U,i=f(p("u-input"),_),r=f(p("u-form-item"),x),d=f(p("u-radio"),C),u=f(p("u-radio-group"),M),m=f(p("u-code"),F),v=f(p("u--form"),V),D=W,L=c("fileChoose"),R=f(p("u-icon"),k),$=f(p("uv-skeletons"),A),j=f(p("u-line"),w),P=f(p("z-paging"),E),O=f(p("u-modal"),z);return I(),g(b,null,[h(P,{style:{"background-color":"#F0F2F7"}},{bottom:y((()=>[h(n,{class:"u-p-b-60"},{default:y((()=>[h(j),h(n,{class:"u-m-t-20 z-mine-submit-btn",onClick:s.submit},{default:y((()=>[N("提交")])),_:1},8,["onClick"])])),_:1})])),default:y((()=>[h(n,null,{default:y((()=>[h(v,{class:"u-p-t-12 u-p-b-12",ref:"uForm",model:t.formModel,labelPosition:"left",labelStyle:{"font-weight":500,color:"#292A2B","margin-left":"8rpx"},labelWidth:"auto"},{default:y((()=>[h(n,{class:"z-mine-setion",style:{padding:"26rpx 30rpx 0 30rpx"}},{default:y((()=>[h(n,{class:"z-mine-setion-title"},{default:y((()=>[N("主体信息登记")])),_:1}),h(r,{required:"",labelWidth:"auto",label:"企业名称",prop:"comName",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.comName,"onUpdate:modelValue":l[0]||(l[0]=e=>t.formModel.comName=e),border:"none",placeholder:"请输入","input-align":"right",clearable:""},null,8,["modelValue"])])),_:1}),h(r,{required:"",label:"营业执照注册号",prop:"comLicenseNum",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.comLicenseNum,"onUpdate:modelValue":l[1]||(l[1]=e=>t.formModel.comLicenseNum=e),border:"none",placeholder:"请输入","input-align":"right",clearable:""},null,8,["modelValue"])])),_:1}),h(r,{required:"",label:"法人身份证姓名",prop:"legalIdname",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.legalIdname,"onUpdate:modelValue":l[2]||(l[2]=e=>t.formModel.legalIdname=e),border:"none",placeholder:"请先填写身份信息","input-align":"right"},null,8,["modelValue"])])),_:1}),h(r,{required:"",label:"法人身份证号码",prop:"legalIdcard",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.legalIdcard,"onUpdate:modelValue":l[3]||(l[3]=e=>t.formModel.legalIdcard=e),border:"none",placeholder:"请输入","input-align":"right",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),h(n,{class:"z-mine-setion",style:{padding:"26rpx 30rpx 10rpx 30rpx"}},{default:y((()=>[h(n,{class:"z-mine-setion-title"},{default:y((()=>[N("管理员信息登记")])),_:1}),h(r,{label:"验证方式",prop:"manageVerifyWay",borderBottom:"",ref:"manageVerifyRef"},{default:y((()=>[h(n,{style:{flex:"1"}}),h(u,{style:{gap:"0","min-width":"360rpx"},modelValue:t.formModel.manageVerifyWay,"onUpdate:modelValue":l[4]||(l[4]=e=>t.formModel.manageVerifyWay=e),placement:"column",size:"16",onChange:s.manageWayRadioChange},{default:y((()=>[(I(!0),g(b,null,B(t.manageVerifyWayList,((e,l)=>(I(),T(d,{key:l,label:e.name,name:e.name,labelSize:"26rpx","active-color":"#2647FF","label-color":"#292A2B"},null,8,["label","name"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1},512),"设置其他人为管理员"==t.formModel.manageVerifyWay?(I(),T(n,{key:0},{default:y((()=>[h(r,{required:"",label:"管理员身份证姓名",prop:"useropr.idname",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.useropr.idname,"onUpdate:modelValue":l[5]||(l[5]=e=>t.formModel.useropr.idname=e),border:"none",placeholder:"请先填写身份信息","input-align":"right"},null,8,["modelValue"])])),_:1}),h(r,{required:"",label:"管理员身份证号码",prop:"useropr.idcard",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.useropr.idcard,"onUpdate:modelValue":l[6]||(l[6]=e=>t.formModel.useropr.idcard=e),border:"none",placeholder:"请输入","input-align":"right",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})):q("",!0),h(r,{required:"",label:"手机号码",prop:"useropr.phone",borderBottom:""},{default:y((()=>[h(i,{modelValue:t.formModel.useropr.phone,"onUpdate:modelValue":l[7]||(l[7]=e=>t.formModel.useropr.phone=e),border:"none",placeholder:"请输入","input-align":"right",type:"number",clearable:""},null,8,["modelValue"])])),_:1}),h(r,{required:"",label:"短信验证码",prop:"useropr.smscode",borderBottom:""},{default:y((()=>[h(i,{class:"u-m-r-20",modelValue:t.formModel.useropr.smscode,"onUpdate:modelValue":l[8]||(l[8]=e=>t.formModel.useropr.smscode=e),border:"none",placeholder:"请输入","input-align":"right",type:"number",clearable:""},null,8,["modelValue"]),h(m,{ref:"uCode",seconds:120,changeText:"Xs重新获取",onChange:e.codeChange,onEnd:e.codeEnd},null,8,["onChange","onEnd"]),t.canSend?(I(),T(n,{key:0,style:{color:"#2647FF"}},{default:y((()=>[N("发送验证码")])),_:1})):(I(),T(n,{key:1},{default:y((()=>[N(S(t.codeText),1)])),_:1}))])),_:1})])),_:1})])),_:1},8,["model"]),h(n,{class:"z-mine-setion",style:{padding:"26rpx 30rpx 26rpx 30rpx"}},{default:y((()=>[h(n,{class:"z-mine-setion-title"},{default:y((()=>[h(D,{style:{color:"#f56c6c"}},{default:y((()=>[N("*")])),_:1}),N(" 授权书上传")])),_:1}),h(n,{class:"z-mine-setion-title u-flex u-flex-between u-m-t-40",style:{"font-size":"24rpx"}},{default:y((()=>[h(D,null,{default:y((()=>[N("授权书模板")])),_:1}),h(D,{style:{color:"#2647FF"},onClick:s.downLoadTempFile},{default:y((()=>[N("下载授权模板")])),_:1},8,["onClick"])])),_:1}),h(n,{class:"u-m-t-30"},{default:y((()=>[h(D,{class:"z-mine-setion-title",style:{"font-size":"26rpx"}},{default:y((()=>[N("附件上传 ")])),_:1}),h(D,{style:{"font-size":"22rpx",color:"#a8b0bc","font-weight":"400"}},{default:y((()=>[N("（请通过授权书上传企业验证）")])),_:1})])),_:1}),h(L,{ref:"fileWrapCer",onFilesChange:s.fileChangeCer,editFiles:t.editFilesCer},null,8,["onFilesChange","editFiles"])])),_:1}),h($,{animate:!0,loading:t.loading,skeleton:t.skeleton},{default:y((()=>[t.payInfo?(I(),T(n,{key:0,class:"z-mine-setion",style:{padding:"26rpx 30rpx 26rpx 30rpx"}},{default:y((()=>[h(n,{class:"z-mine-setion-title"},{default:y((()=>[N("支付验证信息")])),_:1}),h(n,{style:{"margin-top":"30rpx",padding:"20rpx","background-color":"#F9F9F9"}},{default:y((()=>[h(n,{style:{"font-size":"24rpx",color:"#666E81","border-radius":"8px"}},{default:y((()=>[N(" 1、为验证真实性，此对公账户需给平台打款验证，请尽快联系贵公司/单位财务进行打款，金额不限；2、平台收到汇款后，会将注册结果发至管理员消息；3、打款将原路退回至您的对公账户。 ")])),_:1}),h(n,{class:"u-m-t-30 u-flex",style:{"font-size":"24rpx"}},{default:y((()=>[h(D,{style:{flex:"1",color:"#666E81"}},{default:y((()=>[N("开户名称")])),_:1}),h(D,{style:{color:"#292A2B","font-weight":"500"}},{default:y((()=>[N(S(t.payInfo.payName),1)])),_:1}),h(R,{onClick:l[9]||(l[9]=e=>s.copyText(t.payInfo.payName)),class:"u-m-l-8",name:"/static/image/common/ic_copy.png"})])),_:1}),h(n,{class:"u-m-t-20 u-flex",style:{"font-size":"24rpx"}},{default:y((()=>[h(D,{style:{flex:"1",color:"#666E81"}},{default:y((()=>[N("开户银行")])),_:1}),h(D,{style:{color:"#292A2B","font-weight":"500"}},{default:y((()=>[N(S(t.payInfo.payBankName),1)])),_:1}),h(R,{onClick:l[10]||(l[10]=e=>s.copyText(t.payInfo.payBankName)),class:"u-m-l-8",name:"/static/image/common/ic_copy.png"})])),_:1}),h(n,{class:"u-m-t-20 u-flex",style:{"font-size":"24rpx"}},{default:y((()=>[h(D,{style:{flex:"1",color:"#666E81"}},{default:y((()=>[N("银行支行")])),_:1}),h(D,{style:{color:"#292A2B","font-weight":"500"}},{default:y((()=>[N(S(t.payInfo.payBankAdd),1)])),_:1}),h(R,{onClick:l[11]||(l[11]=e=>s.copyText(t.payInfo.payBankAdd)),class:"u-m-l-8",name:"/static/image/common/ic_copy.png"})])),_:1}),h(n,{class:"u-m-t-20 u-flex",style:{"font-size":"24rpx"}},{default:y((()=>[h(D,{style:{flex:"1",color:"#666E81"}},{default:y((()=>[N("银行账号")])),_:1}),h(D,{style:{color:"#292A2B","font-weight":"500"}},{default:y((()=>[N(S(t.payInfo.payBankNum),1)])),_:1}),h(R,{onClick:l[12]||(l[12]=e=>s.copyText(t.payInfo.payBankNum)),class:"u-m-l-8",name:"/static/image/common/ic_copy.png"})])),_:1})])),_:1}),h(n,{class:"u-m-t-30"},{default:y((()=>[h(D,{class:"z-mine-setion-title",style:{"font-size":"26rpx"}},{default:y((()=>[N("支付凭证上传")])),_:1}),h(D,{style:{"font-size":"22rpx",color:"#a8b0bc","font-weight":"400"}},{default:y((()=>[N("（付款凭证可以在提交企业认证后补上")])),_:1})])),_:1}),h(L,{ref:"fileWrap",onFilesChange:s.fileChange,editFiles:t.editFiles},null,8,["onFilesChange","editFiles"])])),_:1})):q("",!0)])),_:1},8,["loading","skeleton"]),h(n,{style:{margin:"20rpx 30rpx","font-size":"24rpx",color:"#a8b0bc"}},{default:y((()=>[N(" * 多式联运智慧大脑平台致力于打造真实、合法、有效的互联网平台。为了更好的保障你和广大用户的合法权益，请你认真填写以下登记信息。 ")])),_:1})])),_:1})])),_:1}),h(O,{show:t.showModal,width:"600rpx",closeOnClickOverlay:!0,onConfirm:s.actionConfirm,onClose:s.closeModal,onCancel:s.closeModal,ref:"uModal",showCancelButton:!0,asyncClose:!0},{default:y((()=>[h(n,null,{default:y((()=>[h(n,{style:{"text-align":"center"}},{default:y((()=>[N("提示")])),_:1}),h(n,{class:"u-m-t-30"},{default:y((()=>[N("主体信息提交后不可修改")])),_:1}),h(n,null,{default:y((()=>[h(n,{class:"u-m-t-10"},{default:y((()=>[h(D,{style:{color:"#666E81"}},{default:y((()=>[N("主体名称：")])),_:1}),h(D,null,{default:y((()=>[N(S(t.formModel.comName),1)])),_:1})])),_:1}),h(n,{class:"u-m-t-10"},{default:y((()=>[h(D,{style:{color:"#666E81"}},{default:y((()=>[N("主体类型：")])),_:1}),h(D,null,{default:y((()=>[N("公司")])),_:1})])),_:1})])),_:1}),h(n,{class:"u-m-t-40",style:{color:"#666E81"}},{default:y((()=>[N("你需对填的资料真实性、合法性、准确性和有效性")])),_:1})])),_:1})])),_:1},8,["show","onConfirm","onClose","onCancel"])],64)}],["__scopeId","data-v-2fda2894"]]);export{R as default};
